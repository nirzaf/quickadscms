var IndexClass=BaseClass.extend({init:function(){this._super(),"olxin"==window.sitecode&&this.initGeoAutoSuggest(),this.initGeosuggest(),this.initOther(),this.initFacebook(),this.isModuleActive("island_trending")&&this.initIsland("trendingads","INT-3-[HP]"),this.isModuleActive("island_interesting")&&this.initIsland("interestingads","INT-4-[HP]"),this.initTable(),this.initFacebookBug(),this.isModuleActive("phoneusers")&&this.initMergeForm(),this.isModuleActive("paid_subscriptions")&&this.initPaidSubscriptionsNotice(),this.initLatestAds(),1==$(".latestads").is(":visible")&&this.initCarousel(),this.youTubePlayer(),$("#loginprompt").length&&this.initLoginPrompt(),$(".app-dl-banner").click(function(t){$(t.target).hasClass("dl-link")||(window.location=$(this).data("location"))})},initLoginPrompt:function(){window.user_logged||$("#loginprompt").show()},initFacebook:function(){if("undefined"==typeof fb_connect_url)return!1;var t=$.ajaxSettings.cache;$.ajaxSettings.cache=!0,$.getScript(fb_connect_url,function(){FB.init({appId:fb_app_id,status:!0,cookie:!0,xfbml:!0})}),$.ajaxSettings.cache=t},fblockActive:function(t,e){$(e).find(".fblock").removeClass("active"),$(t).closest(".fblock").addClass("active")},geolocation:function(){var t=$.Deferred(),e="Fail to read your position";return navigator.geolocation&&"getCurrentPosition"in navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){$(this).trigger("geolocalized",[e.coords]),t.resolve(e.coords)},function(i){switch(i.code){case i.PERMISSION_DENIED:case i.POSITION_UNAVAILABLE:e=e;break;case i.TIMEOUT:e+=" (Timeout)";break;case i.UNKNOWN_ERROR:e=e}i&&"object"==typeof i||(i={}),i.value=e,t.reject(i)},{timeout:5e3}):(error={},error.value=e,t.reject(error)),t.promise()},initGeoAutoSuggest:function(){1!=$.cookie("i2GeoSuggest")&&$.when(this.geolocation()).then(function(t){$.get(www_base+"/i2/ajax/suggest/city/",{lon:t.longitude,lat:t.latitude,suggest:"1"},function(t){""!=t&&($container=$(".chooselocationPop"),$links=$container.find("ul"),$links.html(t),$container.show(),$.fn.geosuggest.bindAutoSuggestCitiesLinks($container,$.fn.geosuggest.settings),$container.find("a.close").click(function(t){t.preventDefault(),$.cookie("i2GeoSuggest","1",{expires:null,path:"/",domain:"."+session_domain}),$container.remove()}))})})},initGeosuggest:function(){var t=this,e=$("#cityField"),i=e.attr("defaultval"),a=e.attr("defaultalternative");e.focus(function(){if(e.val()!=i&&e.val()!=a||e.val(""),""==e.val())e.val(a),e.addClass("ca2"),e.setSelection(0,0);else{var s=e.val().length;e.setSelection(s,s)}t.fblockActive(this,".searchmain")}).blur(function(){e.val()==a&&e.val(i)}).keydown(function(){e.val()!=i&&e.val()!=a||e.val("").removeClass("ca2")}).geosuggest({showGeoSuggestions:!1,saveAsDefaultLocationInCookie:!0,loadDefaultLocationFromCookie:!0,distanceSelect:$("#distanceSelect"),citiesOld:1===window.module_cities_old,locationChanged:function(e,i,a,s,o,n,r){var l="";void 0!==r&&(l=r.replace(";","_").replace(":","-")),"olxua"==sitecode||"olxkz"==sitecode&&1==window.module_cities_old?$("#maincat-grid").find('a[data-search="1"]').each(function(){$(this).attr("href",$(this).data("url").replace(/(http[s]?:\/\/)/g,"$1"+l+(l.length?".":"")))}):(void 0!==s&&0!=s?(l+="/?search[district_id]="+s,void 0!==o&&0!=o&&(l+="&search[dist]="+o)):l.length&&void 0!==o&&0!=o&&(l+="/?search[dist]="+o),$("#maincat-grid").find('a[data-search="1"]').each(function(){$(this).attr("href",$(this).data("url")+l)})),t.isModuleActive("island_trending")&&t.get("island","trending",{cityID:a},function(e){"ok"===e.status&&""!==e.content&&($("#island-trendingads .trendingads-carousel").html(e.content),t.initIsland("trendingads","INT-3-[HP]"))})}})},initOther:function(){var t=this;$.fn.setCursorPosition=function(t){return this.each(function(e,i){if(i.setSelectionRange)i.setSelectionRange(t,t);else if(i.createTextRange){var a=i.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}}),this},$("input#headerSearch").focus(function(){$this=$(this),""==$this.val()?($this.addClass("ca2").val($this.attr("defaultval")),$this.setCursorPosition(0)):$this.val()==$this.attr("defaultval")&&($this.val($this.attr("defaultval")),$this.setCursorPosition(0)),$("#distanceSelect").find("ul").addClass("hidden").hide(),$("#categorySelectList").hide(),t.fblockActive(this,".searchmain")}).keydown(function(){$this=$(this),$this.val()==$this.attr("defaultval")&&$this.removeClass("ca2").val("")}).keyup(function(){$this=$(this),0==$this.val().length&&($this.addClass("ca2").val($this.attr("defaultval")),$this.setCursorPosition(0))}).click(function(){$this=$(this),$this.val()==$this.attr("defaultval")&&$this.setCursorPosition(0)}).bind("paste",function(){$this=$(this),$this.val()==$this.attr("defaultval")&&$this.removeClass("ca2").val("")}),-1!=$.inArray(sitecode,["olxpk","otomotopl","autovitro"])&&null==$.cookie("newolx")||$("input#headerSearch").focus(),$("#lastsearchclear").click(function(){return $this=$(this),$.get(www_base_ajax+"/misc/clearcategories/",function(){$(".lastsearch, .youractivity").fadeOut()}),!1});var e=null,i=$("#lastsearchBox").width()-$("#lastsearchclear").outerWidth(!0);function a(){$(window).width()<"1110"?$("body").addClass("smallscreen"):$("body").removeClass("smallscreen")}if($("#lastsearchBox a.item").each(function(t){e+=$(this).outerWidth(!0),i>e&&$(this).show()}),a(),$(window).resize(function(){a()}),$("#categorySelect").size()>0){var s=28*$("#categorySelectList > li").length,o=$("#categorySelect").offset().top+$("#categorySelect").height();function n(){if($("#categorySelectList").is(":visible")){var t=$(window).height()-o-18+$(document).scrollTop();s<t?$("#categorySelectList").css("max-height","none"):$("#categorySelectList").css("max-height",t)}}$(window).resize(function(){n()}),$("#categorySelect").click(function(){t.fblockActive(this,".searchmain");var e=$("#categorySelectList");return e.toggle(),e.is(":visible")&&$(document).trigger("hidedropdowns"),n(),!1}),$(".categorySelectA1, .categorySelectA2").click(function(){return $("#categorySelectList").hide(),$("#categorySelectHidden").val($(this).data("id")),$("#categorySelectName").text($(this).data("name")),$("#categorySelect").addClass("data-inserted"),$("#categorySelect").removeClass(function(t,e){return(e.match(/\ba-category-\S+/g)||[]).join(" ")}),$("#categorySelect").addClass($(this).data("icon_class")),!1}),$(document).bind("click",function(t){$(t.target).parents().hasClass("categorySelectList")||$("#categorySelectList").hide()});var r=null;function l(){null!=r&&window.clearTimeout(r),r=window.setTimeout(function(){var t=$("input#headerSearch"),e=t.val();t.val()==t.attr("defaultval")&&t.val(""),$.post(www_base_ajax+"/searchfacets/",$("#searchmain").serialize(),function(t){var e=t.data;$(".categorySelectA1, .categorySelectA2").find("span.counter").each(function(){e[$(this).data("id")]?$(this).html(e[$(this).data("id")]).removeClass("hidden"):$(this).addClass("hidden")})}),t.val(e)},600)}$("body").live("geo-suggest-selected",function(t){l()}),$("select#distanceSelect, #cityField").change(function(){l()}),$("input#headerSearch").blur(function(){l()})}},initIsland:function(t,e){for(var i=this,a=$("."+t+"-carousel"),s=0;s<4;s++){var o=$(a.find("div")[s]).find("img");o.attr("src",o.data("src"))}this[t+"Carousel"]={prevArrow:$("#island-"+t+" .prev-arrow"),nextArrow:$("#island-"+t+" .next-arrow"),cDiv:a,wrapper:$("#island-"+t+" .wrapper"),bottomDots:$("#island-"+t+" .island-bottom-dots"),slidesToShow:4,startSlide:5,curPos:0,lock:!1,offsetLeft:0,wrapperWdth:0,curDot:0,init:function(){var e=i[t+"Carousel"];0!=e.cDiv.length&&(e.curPos=0,e.lock=!1,e.startSlide=5,e.slideWidth=$(e.cDiv.find("div")[0]).outerWidth(!0),e.totSlides=$(e.cDiv.find("div")).length,e.slideGap=parseInt($(e.cDiv.find("div")[0]).css("marginRight")),e.wrapperWdth=e.slideWidth*e.slidesToShow-e.slideGap+5,e.wrapper.css({width:e.wrapperWdth+"px"}),e.cDiv.css({width:e.slideWidth*e.totSlides+"px",left:"0"}),e.offsetLeft=e.cDiv.position().left>0?e.cDiv.position().left:0,e.initDots(),e.updateArrows(),e.bindEvents())},initDots:function(){for(var e=i[t+"Carousel"],a="",s=0;s<e.totSlides/e.slidesToShow;s++)a+="<span></span>";e.bottomDots.html("").append(a);var o=e.bottomDots.find("span").length>1?parseInt($(e.bottomDots.find("span").last()).css("marginRight")):0,n=$(e.bottomDots.find("span")[0]).outerWidth(!0)*$(e.bottomDots.find("span")).length+o,r=(e.wrapperWdth-n)/2;e.bottomDots.css({width:n+"px",left:r+"px"}),e.curDot=0,$(e.bottomDots.find("span")[e.curDot]).addClass("active")},bindEvents:function(){var a=i[t+"Carousel"];a.prevArrow.unbind("click"),a.prevArrow.bind("click",function(){1!=$(this).hasClass("disable")&&1!=a.lock&&a.startAnim("right")}),a.nextArrow.unbind("click"),a.nextArrow.bind("click",function(){if(1!=$(this).hasClass("disable")&&1!=a.lock){var t;for(a.startAnim("left"),t=a.startSlide;t<a.startSlide+a.slidesToShow;t++){var e=$(a.cDiv.find("div")[t-1]);e.removeClass("hidden");var i=e.find("img");i.attr("src",i.data("src"))}a.startSlide=t}}),a.cDiv.find("div a").unbind("click"),a.cDiv.find("div a").bind("click",function(t){$this=$(this),t=t||window.event,xt_adc(this,e)}),a.cDiv.find("div img").unbind("load"),a.cDiv.find("div img").load(function(){$(this).parent().find("span.loader").delay(800).fadeOut(500)})},startAnim:function(e){var a=i[t+"Carousel"];a.lock=!0;var s=a.slideWidth*a.slidesToShow,o="left"==e?a.cDiv.position().left-(s+a.offsetLeft):a.cDiv.position().left+(s-a.offsetLeft);a.cDiv.animate({left:o+"px"},"slow",function(){a.updateCurPos(e)})},updateCurPos:function(e){var a=i[t+"Carousel"];"left"==e?a.curPos<a.totSlides&&(a.curPos+=a.slidesToShow):a.curPos>0&&(a.curPos-=a.slidesToShow),a.updateArrows(),a.updateDots(e)},updateArrows:function(){var e=i[t+"Carousel"];0==e.curPos&&e.slidesToShow>e.totSlides?(e.nextArrow.addClass("disable"),e.prevArrow.addClass("disable")):0==e.curPos&&e.slidesToShow<e.totSlides?(e.nextArrow.removeClass("disable"),e.prevArrow.addClass("disable")):e.curPos+e.slidesToShow>=e.totSlides?(e.nextArrow.addClass("disable"),e.prevArrow.removeClass("disable")):(e.prevArrow.removeClass("disable"),e.nextArrow.removeClass("disable")),e.lock=!1},updateDots:function(e){var a=i[t+"Carousel"];$(a.bottomDots.find("span")).removeClass("active"),"left"==e?a.curDot+=1:a.curDot>0&&(a.curDot-=1),$(a.bottomDots.find("span")[a.curDot]).addClass("active")}},i[t+"Carousel"].init()},initFacebookBug:function(){"#_=_"==window.location.hash&&(window.location.hash="","undefined"!=$.type(history.pushState)&&history.pushState("",document.title,window.location.pathname))},initMergeForm:function(){$("#mergemail").validate({rules:{email:{required:!0,email:!0,maxlength:255}},messages:{email:{required:"This field is required",email:"Invalid email format",maxlength:"Cannot be longer than 255 chars"}}}),$("#mergesms").validate({rules:{phone:{required:!0,cellphone:!0}},messages:{phone:{required:"This field is required"}}})},initTable:function(){var t=$(".pager").length>0,e=Main.isTouchDevice()?"touchstart click":"click",i=$("#userAdsFrom");if(i.length){var a=$("#globalCheckbox"),s=$("#adsTable tbody input.checkbox"),o=$("#globalActions li"),n=$("#globalLinks"),r=n.data("type"),l=null==$.cookie("facebooksuccess"),c=$('[name="title"]',i),d=c.siblings(".clear-input-button"),u=c.val()!=c.data("defaultText");c.focus(function(){c.removeClass("ca2").parent().find(".button").addClass("active"),$.trim(c.val())==c.data("defaultText")&&c.val("")}).blur(function(){$.trim(c.val())||(c.val(c.data("defaultText")),c.addClass("ca2").parent().find(".button").removeClass("active"))}),c.val()!=c.data("defaultText")&&c.removeClass("ca2").parent().find(".button").addClass("active"),c.bind("keyup change paste input",function(t){var e=$(this);e.val().length>0&&e.val()!=e.data("defaultText")?d.removeClass("hidden"):d.addClass("hidden")}),d.click(function(){$(this).addClass("hidden"),c.val("").focus(),u&&i.submit()}),i.submit(function(){return c.val()!=c.data("defaultText")});var f=function(t,e){var i=a.closest("th").find("label.f_checkbox"),n=s.filter(":checked:visible"),r=s.filter(":visible").length;t&&(n.length?(a.attr("checked","checked"),i.addClass("selected"),n.length==r?i.removeClass("disabled"):i.addClass("disabled"),o.closest("thead").find(".globalActionHide").css("visibility","hidden")):(a.attr("checked",!1),i.removeClass("selected").removeClass("disabled"),o.closest("thead").find(".globalActionHide").css("visibility","visible"))),o.hide().removeClass("disabled"),n.each(function(){var t=$(this).closest("tr.row-elem"),e=t.next("tr.row-stats"),i=t.find("a.globalAction:visible"),a=0;(i=$.merge(i,e.find("a.globalAction:visible"))).each(function(){var t=$(this).data("code"),e=$(this).data("allowed");void 0===e&&(e=1);var i=o.filter("#"+t);e&&i.show()}),o.removeClass("first").each(function(){var t=$(this);t.is(":visible")&&0==a&&(t.addClass("first"),a++),i.filter("."+t.attr("id")+":visible").length||t.addClass("disabled")})}),$("#globalActions > li:visible").length>3?$("#globalActions").parent().css("height",48):$("#globalActions").parent().css("height","auto")},h=function(t,e){var i=t.next(".row-stats"),a=i.next(".row-shadow").find(".action_js");a.find("span.message").html(e),a.find("img.loader").show();var s=i.height()+t.height(),o=i.width();return a.css({height:s,width:o}).show(),a.find("p").css("marginTop",-a.find("p").height()/2),a},v=function(t){var e="Specify the reason for deactivating your Ad...";$(window).resize(function(){var t=$(window).height()-100;$("#reasonInnerHeight").css({maxHeight:t,overflow:"auto"})}),$.fancybox({href:"#reasonDiv",onStart:function(){var t=$("#reasonDiv");t.show().find("textarea").val(e).hide().parent().siblings("p").hide(),t.find(".removeReason").attr("checked",!1);var i=$(window).height()-100;$("#reasonInnerHeight").css({maxHeight:i,overflow:"auto"})},onClosed:function(){$("#reasonDiv").hide()},onComplete:function(){var i=$("#fancybox-wrap");i.data("ids",t),void 0==i.data("initialized")&&(i.data("initialized",1),$("#deleteButton",i).click(function(){var a=$(this),s=$("input[name=reson]:checked",i),o=s.val(),n=s.hasClass("success"),r=a.closest("div#reasonDiv").find("textarea:visible").val();if(null!=o){$.fancybox.close(),n&&setTimeout(function(){$.cookie("facebooksuccess","1",{expires:14,path:"/",domain:"."+session_domain}),m()},4e3),t=i.data("ids").split(",");for(id in t){var l=$("a.deactivateme"+t[id]);l.data("reasonID",o),l.data("text",void 0==r||r==e?"":r),l.click()}}else ShowMessage.error("Choose reason")}),$(".removeReason",i).click(function(){$("b.report-countdown").text(255);var t=$(this),i=t.closest("li").find("textarea").val(e);i.length?(i.addClass("c73").css("display","block"),i.parent().siblings("p").show()):(t.closest("ol").find("textarea").hide(),t.closest("ol").find("textarea").parent().siblings("p").hide()),i.focus(function(){var t=$(this),i=t.val();t.parents().find(".fblock").addClass("active"),i==e&&(t.val(""),t.removeClass("c73"))}),i.blur(function(){var t=$(this),i=t.val();t.parents().find(".fblock").removeClass("active"),i||(t.val(e),t.addClass("c73"))}),i.keyup(function(){(t=$(this)).val().length>255&&t.val(t.val().substring(0,255)),$("b.report-countdown").text(255-t.val().length)}),$.fancybox.resize()}))},autoScale:!1,autoDimensions:!0,title:'<p class="marginleft15 lheight22">Choose reason</p>'})};$(".fancyboxBecomeFan a.close").click(function(){$.fancybox.close()});var p=function(t,e){var i=n.find("#type"+t),a=i.find("span.counter"),s=parseInt(a.text().replace("(","").replace("_",""));isNaN(s)&&(s=0),(s+=e)<0&&(s=0),a.text("("+s+")"),s?(i.show(),a.show()):(a.hide(),t==r?setTimeout(function(){$("#active-table").remove(),$("#noAdsBlock").fadeIn(1e3)},2500):i.hide())};a.bind(e,function(){var t=a.closest(".th").find("label.f_checkbox"),e=$("#adsTable tbody label.f_checkbox");t.removeClass("disabled"),a.is(":checked")?(s.attr("checked","checked"),e.addClass("selected"),o.closest("thead").find(".globalActionHide").css("visibility","hidden")):(s.attr("checked",!1),e.removeClass("selected"),o.closest("thead").find(".globalActionHide").css("visibility","visible")),f(!1)}),s.bind(e,function(){f(!0)}),o.bind(e,function(){var t=$(this);if(t.hasClass("disabled"))return!1;var e=t.attr("id"),i=s.filter(":checked");if("deactivateme"==e){var a="";return i.each(function(){a&&(a+=","),a+=$(this).val()}),v(a),!1}if("promoteme"==e){a="";return i.each(function(){a+=a?"&":"?",a+="id[]="+$(this).val()}),window.location=multipay_url+a,!1}return i.each(function(){var t=$(this).closest("tr.row-elem"),i="."+e+":visible";$inputs=t.find(i),$inputs.length?"activatecourier"==e?$inputs.data("status")||$inputs.click():"deactivatecourier"==e?$inputs.data("status")&&$inputs.click():$inputs.click():t.next("tr.row-stats").find(i).click()}).eq(0).each(function(){var t=$(this).closest("tr.row-elem");$("html, body").animate({scrollTop:t.offset().top},100)}),!1});var m=function(){$.fancybox.close(),l&&"olxby"!=sitecode&&(l=0,$.fancybox({href:"#deleteAndLike",width:"auto",onStart:function(){$("#fancybox-outer").addClass("fancyboxBecomeFan"),$("#deleteAndLike").show(),$("#deleteAndLike a.close").click(function(){return $.fancybox.close(),!1})},onComplete:function(){setTimeout("FBMyAccountLayercallback()",2500)},onClosed:function(){$("#deleteAndLike").hide(),$("#fancybox-outer").removeClass("fancyboxBecomeFan"),!t&&$("tr.row-elem:visible").length||window.location.reload()},title:'<p class="marginleft15 lheight22">Your Ad has been deleted</p>',autoScale:!1,autoDimensions:!0}))};FBMyAccountLayercallback=function(){"undefined"!=typeof FB&&(FB.XFBML.parse(),FB.Event.subscribe("edge.create",function(t,e){$.fancybox.close()}))};var g=function(t,e,i){return function(a,o,n){var r=a.responseText,l=4500;if($.hasErrorInAjaxResponse(r)&&(r=new String(r).substring(16)),"Edit your Ad and correct errors before refreshing"==r){r="Edit your Ad and correct errors before refreshing",t.addClass("warning");var c=e.find(".refreshEditError");setTimeout(function(){c.show().find(".remove").click(function(){return c.fadeOut(),!1})},3500)}else if("The Ad needs to be improved before activation"==r){t.addClass("warning");c=e.find(".activateEditError");setTimeout(function(){c.show().find(".remove").click(function(){return c.fadeOut(),!1})},3500)}else"activate_courier_error_wrong_category"==r?(t.addClass("warning"),r="You can't activate courier service for this Ad becouse it is not available for its category",l=5e3):"activate_courier_error_invalid_ad_data"==r?(t.addClass("warning"),r="You have selected one or more Ads that are for Exchange or for Free.",l=5e3):(t.addClass("error"),ajaxErrorHander(r));t.find("span.message").html(r),t.find("img.loader").hide(),t.find("p").css("marginTop",-t.find("p").height()/2),s.attr("checked",!1),$("#adsTable tbody label.f_checkbox").removeClass("selected"),f(!0),setTimeout(function(){t.fadeOut(i,function(){t.removeClass("error").removeClass("warning")})},l)}},w=function(t){var e=t.closest("tr.row-elem");return e.length||(e=t.closest("tr.row-stats").prev("tr.row-elem")),e};$(".checkLogin").bind(e,function(t){var e=t;$this=$(this),$.ajax({type:"POST",url:www_base+"/ajax/myaccount/checklogin/",async:!1,dataType:"json",error:function(t,i,a){e.preventDefault();var s=w($this),o=h(s,"");g(o,s,1e3).call(this,t,i,a)},success:function(t){}}),e.stopPropagation()}),$("#adsTable tbody a.globalAction").bind(e,function(e){var i=$(this),a=w(i),o=a.find("input.adID").val(),n=i.data("code"),l="",c="",d=function(t,e){},u={},m=1e3;switch(n){case"confirmme":l="Confirming Ad...",c="The Ad was confirmed",d=function(t,e){a.next("tr.row-stats").find(".confirmRow").remove(),a.next("tr.row-stats").find(".statsRow").show(),a.find(".confirmtarget").remove(),a.find(".waitingMessage").show(),i.remove(),a.removeClass("reqconfirmation"),setTimeout(function(){t.fadeOut(m),0==sitecode.indexOf("slando")&&window.location.reload()},4e3)};break;case"activateme":l="Activating Ad...",c="The Ad is active",d=function(e,i){p(r,-1),p("active",1),setTimeout(function(){a.fadeOut(m),a.next("tr.row-stats").fadeOut(m).next("tr.row-shadow").fadeOut(m),e.fadeOut(m,function(){!t&&$("tr.row-elem:visible").length||window.location.reload()})},4e3)};break;case"activatemelimited":l="Activating Ad...",c="The Ad is active",d=function(e,i){p(r,-1),p("active",1),setTimeout(function(){a.fadeOut(m),a.next("tr.row-stats").fadeOut(m).next("tr.row-shadow").fadeOut(m),e.fadeOut(m,function(){!t&&$("tr.row-elem:visible").length||window.location.reload()})},4e3)};break;case"removeme":l="Removing Ad...",c="This Ad has been permanently removed",d=function(e,i){p(r,-1),setTimeout(function(){a.fadeOut(m),a.next("tr.row-stats").fadeOut(m).next("tr.row-shadow").fadeOut(m),e.fadeOut(m,function(){!t&&$("a.removeme:visible").length||window.location.reload()})},4e3)};break;case"deactivateme":if(!i.data("reasonID"))return v(o),!1;l="Deactivating Ad...",c="Ad successfully deactivated",d=function(e,i){if(useExternalScripts){var s=xtcustom;delete s.page_name,s.click_name="ad_deleted",s.action_type="deleted",xt_med("C","",s.click_name,"A",null,null,s)}setTimeout(function(){a.fadeOut(m),a.next("tr.row-stats").fadeOut(m).next("tr.row-shadow").fadeOut(m),e.fadeOut(m,function(){!t&&$("tr.row-elem:visible").length||$("#deleteAndLike").is(":visible")||window.location.reload()})},4e3),p(r,-1),p("archive",1)},u={reasonID:i.data("reasonID"),text:i.data("text")};break;case"refreshme":l="Refreshing Ad...",c="Ad successfully refreshed",d=function(t,e){i.remove();var s=$("#dateContainerTpl").clone();s.find(".dateContainer_from").html(e.from).end().find(".dateContainer_to").html(e.to),a.find("p.dateContainer").css({"font-weight":"bold"}).html(s.html()),void 0!==e.message&&(c=e.message),setTimeout(function(){t.fadeOut(m)},5e3)};break;case"activatecourier":l="",c="Livrare cu verificare service has been activated for selected ads",d=function(t,e){var i=a.find(".globalAction.activatecourier").data("metadata");i.allowed=0,i.status=1;var s=a.find(".globalAction.deactivatecourier").data("metadata");s.allowed=1,s.status=1,setTimeout(function(){t.fadeOut(m,function(){a.find("span.courier").fadeIn("slow")})},5e3)};break;case"deactivatecourier":l="",c="Livrare cu verificare service has been deactivated for selected ads",d=function(t,e){var i=a.find(".globalAction.activatecourier").data("metadata");i.allowed=1,i.status=0;var s=a.find(".globalAction.deactivatecourier").data("metadata");s.allowed=0,s.status=0,setTimeout(function(){t.fadeOut(m,function(){a.find("span.courier").fadeOut("slow")})},3e3)}}var b=h(a,l);return ajaxErrorHander=function(){},$.ajax({type:"POST",url:www_base+"/ajax/myaccount/"+n+"/",data:$.extend({adID:o},u),dataType:"json",success:function(t){b.find("span.message").html(null!==t&&t.length?t:c),b.find("img.loader").hide(),b.find("p").css("marginTop",-b.find("p").height()/2),s.attr("checked",!1),$("#adsTable tbody label.f_checkbox").removeClass("selected"),f(!0),d(b,t)},error:g(b,a,m)}),!1}),$(".myoffersnew").renderForms(),$("#adsTable .modInfo").click(function(){var t=$(this).closest("tr.row-stats").prev("tr.row-elem").find("input.adID").val(),e=$(window).height()-150;return $("#moderationDescription"+t).css({maxHeight:e,overflow:"auto",width:"550"}),$.fancybox({href:"#moderationDescription"+t,autoScale:!1,autoDimensions:!0,title:'<p class="marginleft15 lheight22">This Ad was not published</p>',onStart:function(){$("#moderationDescription"+t).find(".fancybox-close").click(function(){return $.fancybox.close(),!1})}}),!1});var b=$(".statsviewscloud");b.length&&(b.bind("mouseenter",function(){var t=$(this),e=t.find(".suggesttitlebottom");clearTimeout(t.data("timeout")),e.is(":hidden")&&e.slideDown("fast")}),b.bind("mouseleave",function(){var t=$(this),e=t.find(".suggesttitlebottom");t.data("timeout",setTimeout(function(){e.is(":hidden")||e.slideUp("fast")},1e3))}),b.find(".clearViews").click(function(){var t=$(this),e=t.closest("tr.row-stats").prev("tr.row-elem"),i=e.find("input.adID").val(),a=t.closest(".suggesttitlebottom");return $.post(www_base+"/ajax/myaccount/clearviews/",{adID:i},function(i){$(".suggesttext",a).fadeOut(function(){$(this).text(i.response).fadeIn(),t.closest("tr.row-stats").find(".statsviewsCounter").text("a"),e.end().find(".statsviewsCounter").text(0)})},"json"),!1}))}},initPaidSubscriptionsNotice:function(){var t=$("#showPaidSubscriptionsDetails"),e=$("#paidSubscriptionsDetails");t.fancybox({onStart:function(){e.show();var t=$(window).height()-200;e.find(".innerHeight").css({maxHeight:t,overflow:"auto"})},title:'<p class="block clr xx-large lheight22 marginleft10">Categories with ads above the limit</p>',titleShow:!0,scrolling:"no",autoScale:!0,autoDimensions:!0,onClosed:function(){e.hide()},onCleanup:function(){e.unwrap()}})},initLatestAds:function(){var t=this;$(".latestads").is(":visible")&&$("#body-container .wrapper").css({"padding-bottom":"20px"}),$(".latestads p a.view-all-top").attr("href",$(".latestad-carousel .view-all a").attr("href")),$("#selectCategory").change(function(){var e=$(this).find("option:selected")[0].id;$(".latestads .latestad-carousel").html("Loading ..."),t.post("latestads","getads",{data:e},function(e){-1!=e.indexOf("title")?($(".latestads .latestad-carousel").html("").append(e),$(".latestads p a.view-all-top").attr("href",$(".latestad-carousel .view-all a").attr("href"))):$(".latestads .latestad-carousel").html("Ads not available right now."),t.adsCarousel.init()})})},initCarousel:function(){var t=this;t.adsCarousel={prevArrow:$(".latestads .prev-arrow"),nextArrow:$(".latestads .next-arrow"),cDiv:$(".latestad-carousel"),wrapper:$(".latestads .wrapper"),bottomDots:$(".bottom-dots"),slidesToShow:5,curPos:0,lock:!1,offsetLeft:0,wrapperWdth:0,curDot:0,init:function(){var e=t.adsCarousel;e.curPos=0,e.lock=!1,e.slideWidth=$(e.cDiv.find("div")[0]).outerWidth(!0),e.totSlides=$(e.cDiv.find("div")).length,e.slideGap=parseInt($(e.cDiv.find("div")[0]).css("marginRight")),e.wrapperWdth=e.slideWidth*e.slidesToShow-e.slideGap,e.wrapper.css({width:e.wrapperWdth+"px"}),e.cDiv.css({width:e.slideWidth*e.totSlides+"px",left:"0"}),e.offsetLeft=e.cDiv.position().left>0?e.cDiv.position().left:0,e.initDots(),e.updateArrows(),e.bindEvents()},initDots:function(){for(var e=t.adsCarousel,i="",a=0;a<e.totSlides/e.slidesToShow;a++)i+="<span></span>";e.bottomDots.html("").append(i);var s=e.bottomDots.find("span").length>1?parseInt($(e.bottomDots.find("span").last()).css("marginRight")):0,o=$(e.bottomDots.find("span")[0]).outerWidth(!0)*$(e.bottomDots.find("span")).length+s,n=(e.wrapperWdth-o)/2;e.bottomDots.css({width:o+"px",left:n+"px"}),e.curDot=0,$(e.bottomDots.find("span")[e.curDot]).addClass("active")},bindEvents:function(){var e=t.adsCarousel;e.prevArrow.bind("click",function(){1!=$(this).hasClass("disable")&&1!=e.lock&&e.startAnim("right")}),e.nextArrow.bind("click",function(){1!=$(this).hasClass("disable")&&1!=e.lock&&e.startAnim("left")})},startAnim:function(e){var i=t.adsCarousel;i.lock=!0;var a=i.slideWidth*i.slidesToShow,s="left"==e?i.cDiv.position().left-(a+i.offsetLeft):i.cDiv.position().left+(a-i.offsetLeft);i.cDiv.animate({left:s+"px"},"slow",function(){i.updateCurPos(e)})},updateCurPos:function(e){var i=t.adsCarousel;"left"==e?i.curPos<i.totSlides&&(i.curPos+=i.slidesToShow):i.curPos>0&&(i.curPos-=i.slidesToShow),i.updateArrows(),i.updateDots(e)},updateArrows:function(){var e=t.adsCarousel;0==e.curPos&&e.slidesToShow>e.totSlides?(e.nextArrow.addClass("disable"),e.prevArrow.addClass("disable")):0==e.curPos&&e.slidesToShow<e.totSlides?(e.nextArrow.removeClass("disable"),e.prevArrow.addClass("disable")):e.curPos+e.slidesToShow>=e.totSlides?(e.nextArrow.addClass("disable"),e.prevArrow.removeClass("disable")):(e.prevArrow.removeClass("disable"),e.nextArrow.removeClass("disable")),e.lock=!1},updateDots:function(e){var i=t.adsCarousel;$(i.bottomDots.find("span")).removeClass("active"),"left"==e?i.curDot+=1:i.curDot>0&&(i.curDot-=1),$(i.bottomDots.find("span")[i.curDot]).addClass("active")}},t.adsCarousel.init()},youTubePlayer:function(){var t=1,e=setInterval(function(){$("#div-gpt-ad-1433503533903-2 iframe").length>0&&$("#div-gpt-ad-1433503533903-2 iframe").contents().find("body").length>0&&(i(),t>20?clearInterval(e):t++)},200),i=function(){$("#div-gpt-ad-1433503533903-2 iframe").contents().find("body").unbind().bind("click",function(t){clearInterval(e);var i=$(this).find("#vidThumb").attr("vidUrl"),a=$(this).find("#vidThumb").attr("tracking"),s='<object type="application/x-shockwave-flash" style="width:500px; height:400px;"';s+=' data="'+i+'">',s+='<param name="movie" value="'+i+'"/>',s+='<param name="allowFullScreen" value="true" />',s+='<param name="allowscriptaccess" value="always" />',s+="</object>",$("#youtubeContainer").html("").append(s),$.fancybox({href:"#youtubeContainer",onStart:function(){$("#youtubeContainer").css({width:"auto",overflow:"auto"}).show()},onComplete:function(){$("#fancybox-close").html("x").addClass("ad-banner")},onCleanup:function(){$("#youtubeContainer").hide()},scrolling:"no",autoScale:!1,autoDimensions:!0,padding:10,centerOnScroll:!0});var o=new Image(1,1);return o.src=a,$("body").append(o),!1})}}});$().ready(function(){new IndexClass});